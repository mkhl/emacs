
;; Fix Emacs 23 `local-function-key-map'
(case (window-system)
  (ns (setq local-function-key-map '(keymap (M-escape . [134217755])
                                            (M-return . [134217741])
                                            (M-clear . [134217740])
                                            (M-linefeed . [134217738])
                                            (M-tab . [134217737])
                                            (M-delete . [134217855])
                                            (M-backspace . [134217855])
                                            (escape . [27])
                                            (return . [13])
                                            (clear . [12])
                                            (linefeed . [10])
                                            (tab . [9])
                                            (kp-equal . [61])
                                            (kp-divide . [47])
                                            (kp-decimal . [46])
                                            (kp-subtract . [45])
                                            (kp-separator . [44])
                                            (kp-add . [43])
                                            (kp-multiply . [42])
                                            (kp-enter . [13])
                                            (kp-tab . [9])
                                            (kp-space . [32])
                                            (kp-9 . [57])
                                            (kp-8 . [56])
                                            (kp-7 . [55])
                                            (kp-6 . [54])
                                            (kp-5 . [53])
                                            (kp-4 . [52])
                                            (kp-3 . [51])
                                            (kp-2 . [50])
                                            (kp-1 . [49])
                                            (kp-0 . [48])
                                            (24 keymap
                                                (64 keymap
                                                    (99 . event-apply-control-modifier)
                                                    (83 . event-apply-shift-modifier)
                                                    (97 . event-apply-alt-modifier)
                                                    (109 . event-apply-meta-modifier)
                                                    (115 . event-apply-super-modifier)
                                                    (104 . event-apply-hyper-modifier)))
                                            (C-S-kp-9 . [C-S-prior])
                                            (C-S-kp-8 . [C-S-up])
                                            (C-S-kp-7 . [C-S-home])
                                            (C-S-kp-6 . [C-S-right])
                                            (C-S-kp-4 . [C-S-left])
                                            (C-S-kp-3 . [C-S-next])
                                            (C-S-kp-2 . [C-S-down])
                                            (C-S-kp-1 . [C-S-end])
                                            (C-S-kp-prior . [C-S-prior])
                                            (C-S-kp-up . [C-S-up])
                                            (C-S-kp-home . [C-S-home])
                                            (C-S-kp-right . [C-S-right])
                                            (C-S-kp-left . [C-S-left])
                                            (C-S-kp-next . [C-S-next])
                                            (C-S-kp-down . [C-S-down])
                                            (C-S-kp-end . [C-S-end])
                                            (S-kp-prior . [S-prior])
                                            (S-kp-up . [S-up])
                                            (S-kp-home . [S-home])
                                            (S-kp-right . [S-right])
                                            (S-kp-left . [S-left])
                                            (S-kp-next . [S-next])
                                            (S-kp-down . [S-down])
                                            (S-kp-end . [S-end])
                                            (kp-delete . [4])
                                            (delete . [4])
                                            (backspace . [127])
                                            (kp-insert . [insert])
                                            (kp-begin . [begin])
                                            (kp-end . [end])
                                            (M-kp-next . [M-next])
                                            (kp-next . [next])
                                            (kp-prior . [prior])
                                            (kp-down . [down])
                                            (kp-right . [right])
                                            (kp-up . [up])
                                            (kp-left . [left])
                                            (kp-home . [home])))))
